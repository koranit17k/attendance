<!-- Created with Jaspersoft Studio version 7.0.3.final using JasperReports Library version 7.0.3-41034ca841d452f3305ba55b9042260aaa1ab5dd  -->
<jasperReport name="สรุปประจำเดือน" language="java" columnCount="1" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="27e5c3a4-33da-4220-aa35-ee1ff2660017">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="payroll"/>
	<property name="com.jaspersoft.studio.property.dataset.dialog.DatasetDialog.sash.w1" value="646"/>
	<property name="com.jaspersoft.studio.property.dataset.dialog.DatasetDialog.sash.w2" value="354"/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageHeight" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.topMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.bottomMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.leftMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.rightMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnSpacing" value="pixel"/>
	<style name="Crosstab 1_CH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 1_CG" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 1_CT" mode="Opaque" backcolor="#005FB3">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 1_CD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<parameter name="pYear" class="java.lang.String">
		<defaultValueExpression><![CDATA[2025]]></defaultValueExpression>
	</parameter>
	<parameter name="pMonth" class="java.lang.String">
		<defaultValueExpression><![CDATA[11]]></defaultValueExpression>
	</parameter>
	<query language="SQL"><![CDATA[SELECT v.*,
    e.comCode as ecom,
    c.comCode as ccom,
    e.name as employee_name,
    c.comName as company_name,
    s.name as scanName
FROM attendance v
    left join scancode s on v.scanCode = s.scanCode
    left join employee e on v.scanCode = e.scanCode
    left  join company c on e.comCode = c.comCode
Where STR_TO_DATE(v.dateAt, '%Y-%m-%d') BETWEEN
      STR_TO_DATE(CONCAT($P!{pYear}, '-', LPAD($P!{pMonth},2,'0'), '-01'), '%Y-%m-%d')
  AND LAST_DAY(
      STR_TO_DATE(CONCAT($P!{pYear}, '-', LPAD($P!{pMonth},2,'0'), '-01'), '%Y-%m-%d')
  )
ORDER BY ecom, scancode]]></query>
	<field name="comCode" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="comCode"/>
		<property name="com.jaspersoft.studio.field.label" value="comCode"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="empCode" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.name" value="empCode"/>
		<property name="com.jaspersoft.studio.field.label" value="empCode"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="scanCode" class="java.lang.String">
		<description><![CDATA[รหัสสแกนลายนิ้วมือ]]></description>
		<property name="com.jaspersoft.studio.field.name" value="scanCode"/>
		<property name="com.jaspersoft.studio.field.label" value="scanCode"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="dateAt" class="java.lang.String">
		<description><![CDATA[วันเดือนปีทำงาน]]></description>
		<property name="com.jaspersoft.studio.field.name" value="dateAt"/>
		<property name="com.jaspersoft.studio.field.label" value="dateAt"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="status" class="java.lang.String">
		<description><![CDATA[สถานะ]]></description>
		<property name="com.jaspersoft.studio.field.name" value="status"/>
		<property name="com.jaspersoft.studio.field.label" value="status"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="day_case" class="java.lang.String">
		<description><![CDATA[ดูวัน]]></description>
		<property name="com.jaspersoft.studio.field.name" value="day_case"/>
		<property name="com.jaspersoft.studio.field.label" value="day_case"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="lunch_case" class="java.lang.String">
		<description><![CDATA[ดูพักเที่ยง]]></description>
		<property name="com.jaspersoft.studio.field.name" value="lunch_case"/>
		<property name="com.jaspersoft.studio.field.label" value="lunch_case"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="night_case" class="java.lang.String">
		<description><![CDATA[ดูค่ำ]]></description>
		<property name="com.jaspersoft.studio.field.name" value="night_case"/>
		<property name="com.jaspersoft.studio.field.label" value="night_case"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="early" class="java.lang.String">
		<description><![CDATA[เวลาออก ข้ามวัน 00:00 - 06:00 (last)]]></description>
		<property name="com.jaspersoft.studio.field.name" value="early"/>
		<property name="com.jaspersoft.studio.field.label" value="early"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="morning" class="java.lang.String">
		<description><![CDATA[เวลาเข้า เช้า 06:00 - 10:00 (last)]]></description>
		<property name="com.jaspersoft.studio.field.name" value="morning"/>
		<property name="com.jaspersoft.studio.field.label" value="morning"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="lunch_out" class="java.lang.String">
		<description><![CDATA[เวลาพักเที่ยง 11:00 - 13:30 (first)]]></description>
		<property name="com.jaspersoft.studio.field.name" value="lunch_out"/>
		<property name="com.jaspersoft.studio.field.label" value="lunch_out"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="lunch_in" class="java.lang.String">
		<description><![CDATA[เวลากลับเที่ยง 11:30 - 14:00 (last)]]></description>
		<property name="com.jaspersoft.studio.field.name" value="lunch_in"/>
		<property name="com.jaspersoft.studio.field.label" value="lunch_in"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="evening" class="java.lang.String">
		<description><![CDATA[เวลาออก เย็น 16:00 - 18:00 (last)]]></description>
		<property name="com.jaspersoft.studio.field.name" value="evening"/>
		<property name="com.jaspersoft.studio.field.label" value="evening"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="night" class="java.lang.String">
		<description><![CDATA[เวลาออก ค่ำ 19:00 - 24:00 (last)]]></description>
		<property name="com.jaspersoft.studio.field.name" value="night"/>
		<property name="com.jaspersoft.studio.field.label" value="night"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="lunch_minutes" class="java.lang.Integer">
		<description><![CDATA[จำนวนนาทีพักกลางวัน]]></description>
		<property name="com.jaspersoft.studio.field.name" value="lunch_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="lunch_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="late_morning_minutes" class="java.lang.Integer">
		<description><![CDATA[จำนวนนาทีมาสาย เช้า]]></description>
		<property name="com.jaspersoft.studio.field.name" value="late_morning_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="late_morning_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="late_lunch_minutes" class="java.lang.Integer">
		<description><![CDATA[จำนวนนาทีมาสาย บ่าย/เที่ยง/ออกก่อนเวลางาน]]></description>
		<property name="com.jaspersoft.studio.field.name" value="late_lunch_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="late_lunch_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="work_minutes" class="java.lang.Integer">
		<description><![CDATA[จำนวนนาทีทำงาน]]></description>
		<property name="com.jaspersoft.studio.field.name" value="work_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="work_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="ot_total_minutes" class="java.lang.Integer">
		<description><![CDATA[จำนวนนาทีล่วงเวลา]]></description>
		<property name="com.jaspersoft.studio.field.name" value="ot_total_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="ot_total_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="count" class="java.lang.Integer">
		<description><![CDATA[จำนวนครั้งที่สแกน]]></description>
		<property name="com.jaspersoft.studio.field.name" value="count"/>
		<property name="com.jaspersoft.studio.field.label" value="count"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="rawTime" class="java.lang.String">
		<description><![CDATA[เวลาที่สแกน]]></description>
		<property name="com.jaspersoft.studio.field.name" value="rawTime"/>
		<property name="com.jaspersoft.studio.field.label" value="rawTime"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="reason" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="reason"/>
		<property name="com.jaspersoft.studio.field.label" value="reason"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="status_check" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="status_check"/>
		<property name="com.jaspersoft.studio.field.label" value="status_check"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="modified_by" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="modified_by"/>
		<property name="com.jaspersoft.studio.field.label" value="modified_by"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="modified_at" class="java.sql.Timestamp">
		<property name="com.jaspersoft.studio.field.name" value="modified_at"/>
		<property name="com.jaspersoft.studio.field.label" value="modified_at"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="approved_by" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="approved_by"/>
		<property name="com.jaspersoft.studio.field.label" value="approved_by"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="approved_at" class="java.sql.Timestamp">
		<property name="com.jaspersoft.studio.field.name" value="approved_at"/>
		<property name="com.jaspersoft.studio.field.label" value="approved_at"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="attendance"/>
	</field>
	<field name="ecom" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="comCode"/>
		<property name="com.jaspersoft.studio.field.label" value="ecom"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="employee"/>
	</field>
	<field name="ccom" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="comCode"/>
		<property name="com.jaspersoft.studio.field.label" value="ccom"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="company"/>
	</field>
	<field name="employee_name" class="java.lang.String">
		<description><![CDATA[ชื่อจริง]]></description>
		<property name="com.jaspersoft.studio.field.name" value="name"/>
		<property name="com.jaspersoft.studio.field.label" value="employee_name"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="employee"/>
	</field>
	<field name="company_name" class="java.lang.String">
		<description><![CDATA[บริษัท ชื่อ]]></description>
		<property name="com.jaspersoft.studio.field.name" value="comName"/>
		<property name="com.jaspersoft.studio.field.label" value="company_name"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="company"/>
	</field>
	<field name="scanName" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="name"/>
		<property name="com.jaspersoft.studio.field.label" value="scanName"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="scancode"/>
	</field>
	<title height="57" splitType="Stretch">
		<element kind="textField" uuid="77f91706-70bb-46b1-8780-b1005ee9bd10" x="290" y="0" width="178" height="34" fontName="Sarabun Thin" fontSize="12.0" hTextAlign="Center" vTextAlign="Middle">
			<expression><![CDATA[$P{JASPER_REPORT}.getName()]]></expression>
		</element>
		<element kind="textField" uuid="9174d50f-387b-4cd6-b113-174c230d209a" x="620" y="2" width="100" height="30">
			<expression><![CDATA["ประจำเดือน " + $P{pMonth} + " / " + $P{pYear}
]]></expression>
		</element>
		<element kind="staticText" uuid="4ea45d9c-2f31-4032-ab43-856f8f0ddf8b" x="1" y="0" width="18" height="20" fontName="Sarabun Light" fontSize="7.0">
			<text><![CDATA[A03]]></text>
		</element>
		<element kind="textField" uuid="c1fb61d6-3ccf-418a-adaf-6f7e5d455ee0" x="786" y="0" width="15" height="20" fontName="Sarabun Thin" fontSize="8.0" evaluationTime="Report" hTextAlign="Left">
			<expression><![CDATA[$V{PAGE_NUMBER}]]></expression>
			<property name="com.jaspersoft.studio.unit.width" value="px"/>
		</element>
		<element kind="textField" uuid="8f6f3eb8-4da9-4239-aee1-c1074b26b788" x="758" y="0" width="25" height="20" fontName="Sarabun Thin" fontSize="8.0" hTextAlign="Right">
			<expression><![CDATA[$V{PAGE_NUMBER}+" /"]]></expression>
			<property name="com.jaspersoft.studio.unit.width" value="px"/>
		</element>
	</title>
	<pageHeader height="35" splitType="Stretch">
		<element kind="textField" uuid="5e3c6189-eb59-4d1a-9d7b-f41e70b82788" x="787" y="0" width="15" height="15" fontName="Sarabun Thin" fontSize="8.0" evaluationTime="Report" hTextAlign="Left">
			<printWhenExpression><![CDATA[$V{PAGE_NUMBER} > 1
]]></printWhenExpression>
			<expression><![CDATA[$V{PAGE_NUMBER}]]></expression>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
		<element kind="textField" uuid="b045afbf-4b73-4d23-a137-380efa9b21f2" x="760" y="0" width="25" height="15" fontName="Sarabun Thin" fontSize="8.0" hTextAlign="Right">
			<expression><![CDATA[$V{PAGE_NUMBER} > 1 ? $V{PAGE_NUMBER} + " /" : ""
]]></expression>
			<property name="com.jaspersoft.studio.unit.width" value="px"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
	</pageHeader>
	<summary height="109" splitType="Stretch">
		<element kind="crosstab" uuid="518b5fa7-9ef2-43c9-aeb4-45b20cc1b216" x="0" y="0" width="802" height="100">
			<dataset/>
			<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
			<property name="com.jaspersoft.studio.crosstab.style.header" value="Crosstab 1_CH"/>
			<property name="com.jaspersoft.studio.crosstab.style.group" value="Crosstab 1_CG"/>
			<property name="com.jaspersoft.studio.crosstab.style.total" value="Crosstab 1_CT"/>
			<property name="com.jaspersoft.studio.crosstab.style.detail" value="Crosstab 1_CD"/>
			<property name="com.jaspersoft.studio.unit.x" value="px"/>
			<rowGroup name="company_name" totalPosition="End" width="30">
				<bucket class="java.lang.String">
					<expression><![CDATA[$F{company_name}]]></expression>
				</bucket>
				<header mode="Opaque" style="Crosstab 1_CH">
					<element kind="textField" uuid="ea6ca828-6b33-4dc3-a4c9-3a743448e687" x="0" y="0" width="30" height="15" fontName="Sarabun Thin" fontSize="8.0" textAdjust="StretchHeight" hTextAlign="Justified">
						<expression><![CDATA[$V{company_name}]]></expression>
					</element>
				</header>
				<totalHeader mode="Opaque" style="Crosstab 1_CG"/>
			</rowGroup>
			<rowGroup name="scanName" totalPosition="End" width="30">
				<bucket class="java.lang.String">
					<expression><![CDATA[$F{scanName}]]></expression>
				</bucket>
				<header mode="Opaque" style="Crosstab 1_CH">
					<element kind="textField" uuid="7229fe09-6fc2-46b9-8e64-990b2648734e" x="0" y="0" width="30" height="10" fontName="Sarabun Thin" fontSize="6.0">
						<expression><![CDATA[$V{scanName}]]></expression>
					</element>
				</header>
				<totalHeader mode="Opaque" style="Crosstab 1_CT"/>
			</rowGroup>
			<columnGroup name="dateAt" totalPosition="End" height="10">
				<bucket class="java.lang.String">
					<expression><![CDATA[$F{dateAt}]]></expression>
				</bucket>
				<header mode="Opaque" style="Crosstab 1_CH">
					<element kind="textField" uuid="08613d8f-ee0c-4afe-9a25-130380c7c087" x="0" y="0" width="24" height="10" fontName="Sarabun Thin" fontSize="6.0">
						<expression><![CDATA[$V{dateAt} != null
? $V{dateAt}.split("-")[$V{dateAt}.split("-").length - 1]
: ""
]]></expression>
					</element>
				</header>
				<totalHeader mode="Opaque" style="Crosstab 1_CT">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</totalHeader>
			</columnGroup>
			<measure name="late_morning_MEAS" calculation="Sum" class="java.lang.Integer">
				<expression><![CDATA[$F{late_morning_minutes}]]></expression>
			</measure>
			<measure name="late_lunch_MEAS" calculation="Sum" class="java.lang.Integer">
				<expression><![CDATA[$F{late_lunch_minutes}]]></expression>
			</measure>
			<measure name="work_minutes_MEAS" calculation="Sum" class="java.math.BigDecimal">
				<expression><![CDATA[$F{work_minutes}]]></expression>
			</measure>
			<cell width="24" height="10">
				<contents mode="Opaque" style="Crosstab 1_CD">
					<element kind="textField" uuid="5bff2a2c-5085-482d-bc18-a42a6c303593" x="0" y="0" width="24" height="10" fontName="Sarabun Thin" fontSize="6.0" pattern="#,##0.###;(#,##0.###-)" blankWhenNull="false">
						<expression><![CDATA[(
  ($V{late_morning_MEAS} == null || $V{late_morning_MEAS} == 0)
  && ($V{late_lunch_MEAS} == null || $V{late_lunch_MEAS} == 0)
)
? ""
:
(
  ($V{late_morning_MEAS} == null || $V{late_morning_MEAS} == 0 ? "" : $V{late_morning_MEAS})
  + " / " +
  ($V{late_lunch_MEAS} == null || $V{late_lunch_MEAS} == 0 ? "" : $V{late_lunch_MEAS})
)
]]></expression>
					</element>
				</contents>
			</cell>
			<cell width="5" height="10" columnTotalGroup="dateAt">
				<contents mode="Opaque" style="Crosstab 1_CT"/>
			</cell>
			<cell width="24" height="15" rowTotalGroup="company_name">
				<contents mode="Opaque" style="Crosstab 1_CG"/>
			</cell>
			<cell width="5" height="15" rowTotalGroup="company_name" columnTotalGroup="dateAt">
				<contents mode="Opaque" style="Crosstab 1_CT"/>
			</cell>
			<cell width="24" height="5" rowTotalGroup="scanName">
				<contents mode="Opaque" style="Crosstab 1_CT">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</contents>
			</cell>
			<cell width="5" height="5" rowTotalGroup="scanName" columnTotalGroup="dateAt">
				<contents mode="Opaque" style="Crosstab 1_CT"/>
			</cell>
		</element>
	</summary>
</jasperReport>
