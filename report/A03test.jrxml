<!-- Created with Jaspersoft Studio version 7.0.3.final using JasperReports Library version 7.0.3-41034ca841d452f3305ba55b9042260aaa1ab5dd  -->
<jasperReport name="A02test" language="java" pageWidth="792" pageHeight="612" orientation="Landscape" columnWidth="752" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="489cab8f-4b60-4fa6-88a9-e8ca5f15513a">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="payroll"/>
	<style name="Crosstab_CH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CG" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CT" mode="Opaque" backcolor="#005FB3">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<parameter name="pYear" class="java.lang.Integer"/>
	<parameter name="pMonth" class="java.lang.Integer"/>
	<query language="SQL"><![CDATA[SELECT
  dd.dateAt as ddateAt,
  v.*,
  e.comCode AS ecom,
  c.comCode AS ccom,
  e.name AS employee_name,
  c.comName AS company_name,
  s.name AS scanName
FROM dim_date dd
LEFT JOIN vAttendanceMinutes v
  ON STR_TO_DATE(v.dateAt, '%Y-%m-%d') = dd.dateAt
LEFT JOIN scancode s ON v.scanCode = s.scanCode
LEFT JOIN employee e ON v.scanCode = e.scanCode
LEFT JOIN company c ON e.comCode = c.comCode
WHERE YEAR(dd.dateAt) = $P{pYear}
  AND MONTH(dd.dateAt) = $P{pMonth}
]]></query>
	<field name="ddateAt" class="java.sql.Date">
		<property name="com.jaspersoft.studio.field.name" value="dateAt"/>
		<property name="com.jaspersoft.studio.field.label" value="ddateAt"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="dim_date"/>
	</field>
	<field name="status" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="status"/>
		<property name="com.jaspersoft.studio.field.label" value="status"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="scanCode" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="scanCode"/>
		<property name="com.jaspersoft.studio.field.label" value="scanCode"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="dateAt" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="dateAt"/>
		<property name="com.jaspersoft.studio.field.label" value="dateAt"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="day_case" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="day_case"/>
		<property name="com.jaspersoft.studio.field.label" value="day_case"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="lunch_case" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="lunch_case"/>
		<property name="com.jaspersoft.studio.field.label" value="lunch_case"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="night_case" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="night_case"/>
		<property name="com.jaspersoft.studio.field.label" value="night_case"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="early" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="early"/>
		<property name="com.jaspersoft.studio.field.label" value="early"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="morning" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="morning"/>
		<property name="com.jaspersoft.studio.field.label" value="morning"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="lunch_out" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="lunch_out"/>
		<property name="com.jaspersoft.studio.field.label" value="lunch_out"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="lunch_in" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="lunch_in"/>
		<property name="com.jaspersoft.studio.field.label" value="lunch_in"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="evening" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="evening"/>
		<property name="com.jaspersoft.studio.field.label" value="evening"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="night" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="night"/>
		<property name="com.jaspersoft.studio.field.label" value="night"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="lunch_minutes" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="lunch_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="lunch_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="late_morning_minutes" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="late_morning_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="late_morning_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="late_lunch_minutes" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="late_lunch_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="late_lunch_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="work_minutes" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="work_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="work_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="ot_total_minutes" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="ot_total_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="ot_total_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="v"/>
	</field>
	<field name="ecom" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="comCode"/>
		<property name="com.jaspersoft.studio.field.label" value="ecom"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="employee"/>
	</field>
	<field name="ccom" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="comCode"/>
		<property name="com.jaspersoft.studio.field.label" value="ccom"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="company"/>
	</field>
	<field name="employee_name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="name"/>
		<property name="com.jaspersoft.studio.field.label" value="employee_name"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="employee"/>
	</field>
	<field name="company_name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="comName"/>
		<property name="com.jaspersoft.studio.field.label" value="company_name"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="company"/>
	</field>
	<field name="scanName" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="name"/>
		<property name="com.jaspersoft.studio.field.label" value="scanName"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="scancode"/>
	</field>
	<background splitType="Stretch"/>
	<title height="48" splitType="Stretch">
		<element kind="textField" uuid="f47156bc-0f48-4741-81a4-55bdb4b18ebe" x="570" y="10" width="100" height="30">
			<expression><![CDATA["ประจำเดือน " + $P{pMonth} + " / " + $P{pYear}
]]></expression>
		</element>
		<element kind="textField" uuid="3e025ca8-35f0-4a27-a929-c7744efff994" x="736" y="0" width="15" height="20" fontName="Sarabun Thin" fontSize="8.0" evaluationTime="Report" hTextAlign="Left">
			<expression><![CDATA[$V{PAGE_NUMBER}]]></expression>
			<property name="com.jaspersoft.studio.unit.width" value="px"/>
		</element>
		<element kind="staticText" uuid="7a672303-f26b-43aa-a2b6-3ceca69ff56f" x="1" y="0" width="18" height="20" fontName="Sarabun Light" fontSize="7.0">
			<text><![CDATA[A02]]></text>
		</element>
		<element kind="textField" uuid="0f0c4c0e-fa18-4070-af83-173c857db9c2" x="708" y="0" width="25" height="20" fontName="Sarabun Thin" fontSize="8.0" hTextAlign="Right">
			<expression><![CDATA[$V{PAGE_NUMBER}+" /"]]></expression>
			<property name="com.jaspersoft.studio.unit.width" value="px"/>
		</element>
		<element kind="textField" uuid="185636b0-587d-4627-933e-2dc239339b54" x="290" y="0" width="178" height="34" fontName="Sarabun Thin" fontSize="12.0" hTextAlign="Center" vTextAlign="Middle">
			<expression><![CDATA[$P{JASPER_REPORT}.getName()]]></expression>
		</element>
	</title>
	<columnHeader height="26" splitType="Stretch">
		<element kind="textField" uuid="f605c872-95fc-4c3e-8ac0-246e316af686" x="736" y="0" width="15" height="15" fontName="Sarabun Thin" fontSize="8.0" evaluationTime="Report" hTextAlign="Left">
			<printWhenExpression><![CDATA[$V{PAGE_NUMBER} > 1
]]></printWhenExpression>
			<expression><![CDATA[$V{PAGE_NUMBER}]]></expression>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
		<element kind="textField" uuid="ecb9f0f0-c2e2-49ff-aa24-65eb46c5aeba" x="711" y="0" width="25" height="15" fontName="Sarabun Thin" fontSize="8.0" hTextAlign="Right">
			<expression><![CDATA[$V{PAGE_NUMBER} > 1 ? $V{PAGE_NUMBER} + " /" : ""
]]></expression>
			<property name="com.jaspersoft.studio.unit.width" value="px"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
	</columnHeader>
	<summary height="81" splitType="Stretch">
		<element kind="crosstab" uuid="83dce788-5d07-4d09-8a49-06227bc033c4" x="0" y="0" width="750" height="70">
			<dataset/>
			<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
			<property name="com.jaspersoft.studio.crosstab.style.header" value="Crosstab_CH"/>
			<property name="com.jaspersoft.studio.crosstab.style.group" value="Crosstab_CG"/>
			<property name="com.jaspersoft.studio.crosstab.style.total" value="Crosstab_CT"/>
			<property name="com.jaspersoft.studio.crosstab.style.detail" value="Crosstab_CD"/>
			<rowGroup name="company_name" totalPosition="End" width="20">
				<bucket class="java.lang.String">
					<expression><![CDATA[$F{company_name}]]></expression>
				</bucket>
				<header mode="Opaque" style="Crosstab_CH">
					<element kind="textField" uuid="b24b07c9-1954-4f3a-ac10-dfc7654f45a1" x="0" y="0" width="20" height="13" fontName="Sarabun Thin" fontSize="6.0" textAdjust="StretchHeight" blankWhenNull="true">
						<expression><![CDATA[$V{company_name}]]></expression>
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					</element>
				</header>
				<totalHeader mode="Opaque" style="Crosstab_CG">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</totalHeader>
			</rowGroup>
			<rowGroup name="scanName" totalPosition="End" width="30">
				<bucket class="java.lang.String">
					<expression><![CDATA[$F{scanName}]]></expression>
				</bucket>
				<header mode="Opaque" style="Crosstab_CH">
					<element kind="textField" uuid="755a7f13-1c7f-4bad-875f-06a1737b0ac0" x="0" y="0" width="30" height="8" fontName="Sarabun Thin" fontSize="6.0">
						<expression><![CDATA[$V{scanName}]]></expression>
						<box leftPadding="2"/>
					</element>
				</header>
				<totalHeader mode="Opaque" style="Crosstab_CT"/>
			</rowGroup>
			<columnGroup name="ddateAt" totalPosition="End" height="10">
				<bucket class="java.sql.Date">
					<expression><![CDATA[$F{ddateAt}]]></expression>
				</bucket>
				<header mode="Opaque" style="Crosstab_CH">
					<element kind="textField" uuid="d428c665-8a95-4744-a29e-a7fe24adae94" x="0" y="0" width="22" height="10" fontName="Sarabun Thin" fontSize="6.0" hTextAlign="Right">
						<expression><![CDATA[$V{ddateAt} != null
? new java.text.SimpleDateFormat("dd").format($V{ddateAt})
: ""
]]></expression>
					</element>
				</header>
				<totalHeader mode="Opaque" style="Crosstab_CT"/>
			</columnGroup>
			<measure name="late_morning_MEAS" calculation="Sum" class="java.lang.Integer">
				<expression><![CDATA[$F{late_morning_minutes}]]></expression>
			</measure>
			<measure name="late_lunch_MEAS" calculation="Sum" class="java.lang.Integer">
				<expression><![CDATA[$F{late_lunch_minutes}]]></expression>
			</measure>
			<measure name="work_minutes_MEAS" calculation="Sum" class="java.lang.Integer">
				<expression><![CDATA[$F{work_minutes}]]></expression>
			</measure>
			<cell width="22" height="8">
				<contents mode="Opaque" style="Crosstab_CD">
					<element kind="textField" uuid="d7a12ec5-326c-499a-9db7-97aa14fb701d" x="0" y="0" width="22" height="8" fontName="Sarabun Thin" fontSize="6.0" hTextAlign="Right">
						<expression><![CDATA[(
  ($V{late_morning_MEAS} == null || $V{late_morning_MEAS} == 0)
  && ($V{late_lunch_MEAS} == null || $V{late_lunch_MEAS} == 0)
)
? ""
:
(
  ($V{late_morning_MEAS} == null || $V{late_morning_MEAS} == 0 ? "" : $V{late_morning_MEAS})
  + " / " +
  ($V{late_lunch_MEAS} == null || $V{late_lunch_MEAS} == 0 ? "" : $V{late_lunch_MEAS})
)
]]></expression>
						<box rightPadding="0"/>
					</element>
				</contents>
			</cell>
			<cell width="5" height="8" columnTotalGroup="ddateAt">
				<contents mode="Opaque" style="Crosstab_CT">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</contents>
			</cell>
			<cell width="22" height="15" rowTotalGroup="company_name">
				<contents mode="Opaque" style="Crosstab_CG"/>
			</cell>
			<cell width="5" height="15" rowTotalGroup="company_name" columnTotalGroup="ddateAt">
				<contents mode="Opaque" style="Crosstab_CT"/>
			</cell>
			<cell width="22" height="5" rowTotalGroup="scanName">
				<contents mode="Opaque" style="Crosstab_CT">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</contents>
			</cell>
			<cell width="5" height="5" rowTotalGroup="scanName" columnTotalGroup="ddateAt">
				<contents mode="Opaque" style="Crosstab_CT"/>
			</cell>
		</element>
	</summary>
</jasperReport>
