<!-- Created with Jaspersoft Studio version 7.0.3.final using JasperReports Library version 7.0.3-41034ca841d452f3305ba55b9042260aaa1ab5dd  -->
<jasperReport name="เช็คเวลาประจำวัน" language="java" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="784f38b8-bca0-4d99-bf12-459c9169125b">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="payroll"/>
	<property name="com.jaspersoft.studio.report.description" value=""/>
	<parameter name="startDate" class="java.lang.String">
		<defaultValueExpression><![CDATA["2025-06-02"]]></defaultValueExpression>
	</parameter>
	<query language="SQL"><![CDATA[SELECT
    status,
    scancode,
    dateAt,
    day_case,
    lunch_case,
    night_case,
    early,
    morning,
    lunch_out,
    lunch_in,
    evening,
    night,
    lunch_minutes,
    late_morning_minutes,
    late_lunch_minutes,
    work_minutes,
  	ot_total_minutes,
  	total_work_minutes
FROM vAttendanceMinutes 
WHERE scancode= scancode and dateAt = $P{startDate}
ORDER BY status, scancode
limit 200
]]></query>
	<field name="status" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="status"/>
		<property name="com.jaspersoft.studio.field.label" value="status"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="scanCode" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="scanCode"/>
		<property name="com.jaspersoft.studio.field.label" value="scanCode"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="dateAt" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="dateAt"/>
		<property name="com.jaspersoft.studio.field.label" value="dateAt"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="day_case" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="day_case"/>
		<property name="com.jaspersoft.studio.field.label" value="day_case"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="lunch_case" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="lunch_case"/>
		<property name="com.jaspersoft.studio.field.label" value="lunch_case"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="night_case" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="night_case"/>
		<property name="com.jaspersoft.studio.field.label" value="night_case"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="early" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="early"/>
		<property name="com.jaspersoft.studio.field.label" value="early"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="morning" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="morning"/>
		<property name="com.jaspersoft.studio.field.label" value="morning"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="lunch_out" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="lunch_out"/>
		<property name="com.jaspersoft.studio.field.label" value="lunch_out"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="lunch_in" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="lunch_in"/>
		<property name="com.jaspersoft.studio.field.label" value="lunch_in"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="evening" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="evening"/>
		<property name="com.jaspersoft.studio.field.label" value="evening"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="night" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="night"/>
		<property name="com.jaspersoft.studio.field.label" value="night"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="lunch_minutes" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="lunch_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="lunch_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="late_morning_minutes" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="late_morning_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="late_morning_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="late_lunch_minutes" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="late_lunch_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="late_lunch_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="work_minutes" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="work_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="work_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="ot_total_minutes" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="ot_total_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="ot_total_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<field name="total_work_minutes" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="total_work_minutes"/>
		<property name="com.jaspersoft.studio.field.label" value="total_work_minutes"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="vAttendanceMinutes"/>
	</field>
	<variable name="totalCount" calculation="Count" class="java.lang.Integer">
		<expression><![CDATA[$F{scanCode}]]></expression>
	</variable>
	<variable name="groupcount" resetType="Group" calculation="Count" resetGroup="statusgroup" class="java.lang.Integer">
		<expression><![CDATA[$F{scanCode}]]></expression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<group name="statusgroup">
		<expression><![CDATA[$F{status}]]></expression>
		<groupHeader>
			<band height="25">
				<element kind="textField" uuid="486666a2-caf8-4391-942a-ee7b0691bfbc" x="35" y="0" width="35" height="15" fontName="Sarabun Thin" hTextAlign="Center">
					<expression><![CDATA[$F{status}.replace("_case", "")
]]></expression>
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="3f10d705-8e61-48d5-9e4f-6e6da8e8cb9f"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</element>
				<element kind="staticText" uuid="9b6ce785-e2be-4148-b35c-418b04d0037a" x="0" y="0" width="35" height="15" fontName="Sarabun Thin" fontSize="10.0" hTextAlign="Center" vTextAlign="Top">
					<text><![CDATA[status]]></text>
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="3f10d705-8e61-48d5-9e4f-6e6da8e8cb9f"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</element>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="46">
				<element kind="textField" uuid="9b0ef167-61c3-46f1-8049-45f39739638a" x="0" y="0" width="100" height="30">
					<expression><![CDATA[$V{totalCount}]]></expression>
				</element>
				<element kind="textField" uuid="e9899933-12d5-4542-afaf-cf7829bba26f" x="110" y="0" width="100" height="30">
					<expression><![CDATA[$V{groupcount}]]></expression>
				</element>
			</band>
		</groupFooter>
	</group>
	<background splitType="Stretch"/>
	<title height="55" splitType="Stretch">
		<element kind="staticText" uuid="71ca2d8c-db63-48df-a378-5f577543e4c9" x="188" y="2" width="179" height="30" fontName="Sarabun Thin" fontSize="15.0" bold="true" italic="false" underline="false" strikeThrough="false" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[รายงานประจำวัน]]></text>
		</element>
		<element kind="textField" uuid="e27966ca-cdc9-4894-a8dc-4153f9bc786a" x="207" y="36" width="140" height="15" hTextAlign="Center">
			<expression><![CDATA["ประจำวันที่ " + $P{startDate}
]]></expression>
		</element>
		<element kind="staticText" uuid="442c8def-8d03-4c89-89b0-9dbcebd796f5" x="2" y="0" width="28" height="20">
			<text><![CDATA[A01]]></text>
		</element>
		<element kind="textField" uuid="9d203060-1c75-4dfd-b28b-849ba764b2a9" x="380" y="20" width="100" height="30">
			<expression><![CDATA[$P{JASPER_REPORTS_CONTEXT}]]></expression>
		</element>
	</title>
	<pageHeader height="23" splitType="Stretch"/>
	<columnHeader height="22" splitType="Stretch">
		<element kind="staticText" uuid="b50ded69-dc73-4b1c-bf08-a471fd3765e6" x="63" y="0" width="44" height="15" fontName="Sarabun Thin" fontSize="9.0" hTextAlign="Center" vTextAlign="Top">
			<text><![CDATA[scan Code]]></text>
			<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d51971cc-1324-4959-b432-9a6ff138b4a8"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
		<element kind="staticText" uuid="bbddf72c-f894-4025-8333-018aa0794801" x="113" y="0" width="60" height="15" fontName="Sarabun Thin" fontSize="9.0" hTextAlign="Center" vTextAlign="Top">
			<text><![CDATA[time in-out]]></text>
			<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d751f7cf-8a69-48fa-b4e2-72da6ea89acd"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
		<element kind="staticText" uuid="71023367-04b7-465c-a045-788fbfb8f352" x="177" y="0" width="73" height="15" fontName="Sarabun Thin" fontSize="9.0" hTextAlign="Center" vTextAlign="Top">
			<text><![CDATA[lunch_time]]></text>
			<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="ad34b8be-d198-49b0-9481-8a347fdb330d"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
		<element kind="staticText" uuid="6440a2e4-9b30-4b09-9c99-e8bb13f21601" x="278" y="0" width="37" height="15" fontName="Sarabun Thin" fontSize="9.0" hTextAlign="Center" vTextAlign="Top">
			<text><![CDATA[night]]></text>
			<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="fd69d04d-bc41-4fe0-b500-3d1f48079701"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
		<element kind="staticText" uuid="e77b1575-b3ec-48a3-be14-63070bdc6c62" x="333" y="0" width="57" height="15" fontName="Sarabun Thin" fontSize="9.0" hTextAlign="Center" vTextAlign="Top">
			<text><![CDATA[lunch_minutes]]></text>
			<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="20dc3754-55e4-415b-90d0-7bb5d64091a1"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
		<element kind="staticText" uuid="d494986b-0be7-46fc-beeb-710e7d4d17d0" x="403" y="0" width="51" height="15" fontName="Sarabun Thin" fontSize="9.0" hTextAlign="Center" vTextAlign="Top">
			<text><![CDATA[late_minutes]]></text>
			<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="cf26e514-54eb-4969-b784-2bb50b3ab014"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
		<element kind="staticText" uuid="0778d01d-4442-48dd-b3b9-1225c2da4227" x="461" y="0" width="37" height="15" fontName="Sarabun Thin" fontSize="9.0" hTextAlign="Center" vTextAlign="Top">
			<text><![CDATA[ot_total]]></text>
			<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="ae5aca1c-b4a1-42e7-b0ac-1e89b194eb69"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
		<element kind="staticText" uuid="c5e1afce-a598-4a44-9732-7bcc5821fb87" x="504" y="0" width="55" height="15" fontName="Sarabun Thin" fontSize="9.0" hTextAlign="Center" vTextAlign="Top">
			<text><![CDATA[total_minutes]]></text>
			<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d8cc3870-8923-41a7-9152-6d1c507b978a"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
	</columnHeader>
	<detail>
		<band height="16" splitType="Stretch">
			<element kind="textField" uuid="325fdd72-6764-487b-aa29-58d2d4876fb4" x="63" y="0" width="44" height="16" fontName="Sarabun Thin" hTextAlign="Center">
				<expression><![CDATA[$F{scanCode}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d51971cc-1324-4959-b432-9a6ff138b4a8"/>
			</element>
			<element kind="textField" uuid="ffa67bf9-f357-4870-9819-f79e7e1e2869" x="114" y="0" width="60" height="16" fontName="Sarabun Thin" hTextAlign="Center">
				<expression><![CDATA[$F{morning}+ " - " +$F{evening}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d751f7cf-8a69-48fa-b4e2-72da6ea89acd"/>
			</element>
			<element kind="textField" uuid="a6d9d08e-296a-499e-8a16-32f9a6864bab" x="279" y="0" width="37" height="16" fontName="Sarabun Thin" blankWhenNull="true" hTextAlign="Center">
				<expression><![CDATA[$F{night}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="fd69d04d-bc41-4fe0-b500-3d1f48079701"/>
			</element>
			<element kind="textField" uuid="acbcc7ff-9a2e-4244-af18-9355184c0935" x="355" y="0" width="22" height="16" fontName="Sarabun Thin" pattern="#,###.###;(#,###.###-)" hTextAlign="Center">
				<expression><![CDATA[$F{lunch_minutes}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="20dc3754-55e4-415b-90d0-7bb5d64091a1"/>
			</element>
			<element kind="textField" uuid="9fb1f3f6-4101-4791-86ff-13ab52eec5de" x="417" y="0" width="22" height="16" fontName="Sarabun Thin" pattern="#,###.###;(#,###.###-)" hTextAlign="Center">
				<expression><![CDATA[$F{late_morning_minutes}.add($F{late_lunch_minutes})
]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="cf26e514-54eb-4969-b784-2bb50b3ab014"/>
			</element>
			<element kind="textField" uuid="17c76019-5b38-406e-9e9e-9035e44abd9e" x="468" y="0" width="22" height="16" fontName="Sarabun Thin" pattern="#,###.###;(#,###.###-)" hTextAlign="Center">
				<expression><![CDATA[$F{ot_total_minutes}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="ae5aca1c-b4a1-42e7-b0ac-1e89b194eb69"/>
			</element>
			<element kind="textField" uuid="92f54e22-3c94-46bb-bf6e-b6e00d540cf1" x="517" y="0" width="22" height="16" fontName="Sarabun Thin" pattern="#,###.###;(#,###.###-)" hTextAlign="Center">
				<expression><![CDATA[$F{total_work_minutes}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d8cc3870-8923-41a7-9152-6d1c507b978a"/>
			</element>
			<element kind="textField" uuid="d2f40a9e-1626-40ab-b6a1-fcb1ab7e5455" x="177" y="0" width="73" height="16" fontName="Sarabun Thin" blankWhenNull="false" bold="false" hTextAlign="Center">
				<expression><![CDATA[($F{lunch_out} == null ? "x" : $F{lunch_out}) + " - " + ($F{lunch_in} == null ? "x" : $F{lunch_in})
]]></expression>
			</element>
			<element kind="textField" uuid="6e10fd9e-7286-43ac-a311-b75cbf856697" x="0" y="0" width="20" height="16" fontName="Sarabun Thin" hTextAlign="Right">
				<expression><![CDATA[$V{statusgroup_COUNT}]]></expression>
				<property name="com.jaspersoft.studio.unit.height" value="px"/>
				<property name="com.jaspersoft.studio.unit.width" value="px"/>
				<property name="com.jaspersoft.studio.unit.x" value="px"/>
			</element>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</band>
	</detail>
	<columnFooter height="45" splitType="Stretch"/>
	<pageFooter height="30" splitType="Stretch"/>
	<summary height="167" splitType="Stretch">
		<element kind="textField" uuid="6001bda1-51a3-4fc6-b555-99089df96436" x="0" y="20" width="188" height="21" fontName="Sarabun Thin" evaluationTime="Report">
			<expression><![CDATA["พนักงานจำนวน "+ $V{totalCount} + " คน"]]></expression>
		</element>
	</summary>
</jasperReport>
